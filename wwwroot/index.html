<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Tamboliya</title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link href="Tamboliya.styles.css" rel="stylesheet" />
</head>

<body>
    <div id="app">Loading...</div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>
    <script src="_content/Microsoft.AspNetCore.Components.WebAssembly.Authentication/AuthenticationService.js"></script>
    <script src="_framework/blazor.webassembly.js"></script>
    <script src="https://unpkg.com/konva@8/konva.min.js"></script>

    <script>
        var anim;
        var imagePosition = {
            x: 200,
            y: 50
        };

        function initAnimation() {
            var stage = new Konva.Stage({
                container: "baseImage",
                width: 990,
                height: 500
            });
            var layer = new Konva.Layer();

            var imageObj = new Image();
            imageObj.src = 'images/marker.png'
            var image = new Konva.Image({
                x: imagePosition.x,
                y: imagePosition.y,
                image: imageObj,
                width: 30,
                height: 30
            });
            layer.add(image);
            stage.add(layer);
            anim = new Konva.Animation(function (frame) {
                image.x(newPosition.x);
                image.y(newPosition.y);
            }, layer);
        }

        function moveFigure(newPosition) {
            console.log(newPosition);
            console.log('start move');
            imagePosition.x = newPosition.x;
            imagePosition.y = newPosition.y;
            initAnimation();
            anim.start();
            console.log('end move');
        }
    </script>


</body>

</html>
